<div class="forgot-password-page">
  <!-- Header -->
  <app-header></app-header>
  <div class="main">
    <section class="pb-0">
      <div class="container mt-4">
        <div class="row justify-content-xl-between justify-content-md-center">
          <div class="col-md-8 col-lg-6 col-xl-6 mt-4">
            <!-- Setpper -->
            <mat-stepper [linear]="false">
              <mat-step [stepControl]="firtForm" label="Xác thực Email của bạn">
                <form class="mt-3" [formGroup]="firtForm">
                  <!-- Email input -->
                  <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Email</mat-label>
                    <input
                      matInput
                      type="email"
                      placeholder="Email"
                      formControlName="email"
                    />

                    @if( email?.invalid && (email?.dirty || email?.touched) ){
                    <mat-error>{{ errorForEmail() }}</mat-error>
                    }
                  </mat-form-field>

                  <button
                    type="button"
                    [disabled]="firtForm.invalid"
                    (click)="onSendForgotPassword()"
                    class="btn btn-lg btn-dark w-100"
                    matStepperNext
                  >
                    Xác nhận
                  </button>
                </form>
              </mat-step>
              <mat-step [stepControl]="secondForm" label="Đặt lại mật khẩu">
                <form class="mt-3" [formGroup]="secondForm">
                  <!-- Token input -->
                  <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Token</mat-label>
                    <input
                      matInput
                      type="text"
                      placeholder="Token"
                      formControlName="token"
                    />

                    @if( token?.invalid && (token?.dirty || token?.touched) ){
                    <mat-error>{{ errorForToken() }}</mat-error>
                    }
                  </mat-form-field>
                  <!-- New Password input -->
                  <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Mật khẩu mới</mat-label>
                    <input
                      matInput
                      [type]="hideNewPassword ? 'password' : 'text'"
                      placeholder="Mật khẩu mới"
                      formControlName="newPassword"
                    />
                    <mat-icon
                      matSuffix
                      (click)="hideNewPassword = !hideNewPassword"
                      >{{
                        hideNewPassword ? "visibility_off" : "visibility"
                      }}</mat-icon
                    >
                    @if( newPassword?.invalid && (newPassword?.dirty ||
                    newPassword?.touched) ){
                    <mat-error>{{ errorForNewPassword() }}</mat-error>
                    }
                  </mat-form-field>

                  <!-- Password Repeat input -->
                  <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Nhập lại mật khẩu</mat-label>
                    <input
                      matInput
                      [type]="hideRepassword ? 'password' : 'text'"
                      placeholder="Nhập lại mật khẩu"
                      formControlName="repassword"
                    />
                    <mat-icon
                      matSuffix
                      (click)="hideRepassword = !hideRepassword"
                      >{{
                        hideRepassword ? "visibility_off" : "visibility"
                      }}</mat-icon
                    >
                    @if( repassword?.invalid && (repassword?.dirty ||
                    repassword?.touched) ){
                    <mat-error>{{ errorForRepassword() }}</mat-error>
                    }
                  </mat-form-field>
                  <div class="row g-2 column-gap-2">
                    <button
                      type="button"
                      class="btn btn-lg btn-dark col-lg-4"
                      matStepperPrevious
                    >
                      Trở lại
                    </button>
                    <button
                      type="button"
                      [disabled]="secondForm.invalid"
                      (click)="onResetPassword()"
                      class="btn btn-lg btn-dark col-lg-4"
                    >
                      Đặt lại
                    </button>
                  </div>
                </form>
              </mat-step>
            </mat-stepper>
          </div>
          <div class="col-md-9 col-lg-6 col-xl-5 d-none d-lg-block">
            <img src="/assets/img/banner.svg" class="img-fluid" />
          </div>
        </div>
      </div>
    </section>
  </div>
</div>
